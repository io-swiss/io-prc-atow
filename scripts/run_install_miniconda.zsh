#!/bin/zsh

set -e

# ------------------------------------------------------------------------------
#
# run_install_miniconda.sh: Install Miniconda on macOS.
#
# ------------------------------------------------------------------------------

# Set the Python version
PYTHON_VERSION="3.11"

echo "=========================================================================="
echo "Downloading Miniconda installer."
echo "--------------------------------------------------------------------------"
curl -L "https://repo.anaconda.com/miniconda/Miniconda3-latest-MacOSX-x86_64.sh" -o "$HOME/miniconda-installer.sh"

echo "=========================================================================="
echo "Installing Miniconda."
echo "--------------------------------------------------------------------------"
chmod +x "$HOME/miniconda-installer.sh"
sh "$HOME/miniconda-installer.sh" -b

echo "=========================================================================="
echo "Initializing Miniconda."
echo "--------------------------------------------------------------------------"
"$HOME/miniconda3/bin/conda" init zsh

echo "=========================================================================="
echo "Updating PATH and activating conda."
echo "--------------------------------------------------------------------------"
export PATH="$HOME/miniconda3/bin:$PATH"

echo "=========================================================================="
echo "Verifying Miniconda installation."
echo "--------------------------------------------------------------------------"
source ~/.zshrc
conda info

echo "=========================================================================="
echo "Installing Python."
echo "--------------------------------------------------------------------------"
conda install -y python=${PYTHON_VERSION}
python3 --version

echo "--------------------------------------------------------------------------"
date +"DATE TIME : %d.%m.%Y %H:%M:%S"
echo "--------------------------------------------------------------------------"
echo "End"
echo "=========================================================================="
